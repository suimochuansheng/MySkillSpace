# ========================================
# SkillSpace é¡¹ç›®æŒç»­é›†æˆå·¥ä½œæµé…ç½®
# CI/CD Pipeline for SkillSpace Project
# ========================================
# æŠ€æœ¯æ ˆï¼š
#   å‰ç«¯ï¼šVue 3 + Vite
#   åŽç«¯ï¼šDjango + DRF + MySQL + Redis
#   çŽ¯å¢ƒï¼šUbuntu Latest
# ========================================

# å·¥ä½œæµåç§°ï¼šå°†æ˜¾ç¤ºåœ¨ GitHub Actions ç•Œé¢ä¸Š
name: SkillSpace CI/CD Pipeline

# ========================================
# å·¥ä½œæµè§¦å‘æ¡ä»¶
# å®šä¹‰ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè‡ªåŠ¨æ‰§è¡Œè¿™ä¸ª CI æµç¨‹
# ========================================
on:
  # push äº‹ä»¶ï¼šå½“ä»£ç æŽ¨é€åˆ°æŒ‡å®šåˆ†æ”¯æ—¶è§¦å‘
  # ä»…æŽ¨æ ¸å¿ƒåˆ†æ”¯ï¼ˆmain/hotfix/*ï¼‰æ—¶è§¦å‘pushäº‹ä»¶ï¼ˆé¿å… feature åˆ†æ”¯é¢‘ç¹ push è§¦å‘ CIï¼‰
  push:
    branches: [ "main", "hotfix/*" ]
  
  # pull_request äº‹ä»¶ï¼šå½“åˆ›å»ºæˆ–æ›´æ–° PR æ—¶è§¦å‘
  # æ‰€æœ‰å‘ã€Œmain/feature/*/fix/*/hotfix/*ã€æ PR æ—¶è§¦å‘ï¼ˆè¦†ç›–æ‰€æœ‰å¼€å‘åœºæ™¯ï¼‰
  pull_request:
    branches: [ "main", "feature/*", "fix/*", "hotfix/*" ]
  
  # workflow_dispatchï¼šå…è®¸åœ¨ GitHub ç•Œé¢æ‰‹åŠ¨è§¦å‘æ­¤å·¥ä½œæµ
  # ç”¨äºŽæµ‹è¯•æˆ–ç´§æ€¥æƒ…å†µä¸‹çš„æ‰‹åŠ¨æ‰§è¡Œ
  workflow_dispatch:

# ========================================
# å…¨å±€çŽ¯å¢ƒå˜é‡
# å®šä¹‰æ‰€æœ‰ä½œä¸šï¼ˆjobsï¼‰éƒ½å¯ä»¥ä½¿ç”¨çš„çŽ¯å¢ƒå˜é‡
# é€šè¿‡ ${{ env.VARIABLE_NAME }} è¯­æ³•å¼•ç”¨
# ========================================
env:
  # Python ç‰ˆæœ¬ï¼šç”¨äºŽåŽç«¯ Django å¼€å‘
  # é€‰æ‹© 3.9 æ˜¯ä¸ºäº†å…¼å®¹ Django 5.x å’Œé¡¹ç›®ä¾èµ–
  PYTHON_VERSION: '3.9'
  
  # Node.js ç‰ˆæœ¬ï¼šç”¨äºŽå‰ç«¯ Vue3 + Vite æž„å»º
  # ä½¿ç”¨ LTS ç‰ˆæœ¬ 20 ä¿è¯ç¨³å®šæ€§
  NODE_VERSION: '20'
  
  # å‰ç«¯æž„å»ºè¾“å‡ºç›®å½•ï¼šVite æ‰“åŒ…åŽç”Ÿæˆçš„é™æ€æ–‡ä»¶ä½ç½®
  FRONTEND_BUILD_DIR: frontend/skillspace/dist
  
  # åŽç«¯é¡¹ç›®ç›®å½•ï¼šDjango é¡¹ç›®æ ¹ç›®å½•
  BACKEND_DIR: backend

# ========================================
# ä½œä¸šå®šä¹‰ï¼šå®šä¹‰éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡
# ä»¥ä¸‹ 4 ä¸ªä½œä¸šå°†å¹¶è¡Œæ‰§è¡Œï¼ˆé™¤éžæœ‰ä¾èµ–å…³ç³»ï¼‰
# ========================================
jobs:
  # ========================================
  # ä½œä¸š1ï¼šå‰ç«¯æµ‹è¯•å’Œæž„å»º
  # ç›®çš„ï¼šå®‰è£…å‰ç«¯ä¾èµ–å¹¶æž„å»ºç”Ÿäº§ç‰ˆæœ¬
  # è¿è¡ŒçŽ¯å¢ƒï¼šUbuntu æœ€æ–°ç‰ˆ
  # ========================================
  frontend-test-build:
    # ä½œä¸šæ˜¾ç¤ºåç§°ï¼ˆåœ¨ GitHub Actions ç•Œé¢ä¸Šæ˜¾ç¤ºï¼‰
    name: å‰ç«¯æµ‹è¯•ä¸Žæž„å»º (Vue 3)
    
    # æŒ‡å®šè¿è¡Œè¯¥ä½œä¸šçš„è™šæ‹Ÿæœºç³»ç»Ÿï¼ˆGitHub æä¾›çš„å…è´¹è¿è¡Œå™¨ï¼‰
    runs-on: ubuntu-latest
    
    # é»˜è®¤è®¾ç½®ï¼šæ‰€æœ‰ run å‘½ä»¤çš„å·¥ä½œç›®å½•
    # è¿™æ ·æ¯ä¸ªæ­¥éª¤éƒ½ä¸éœ€è¦é‡å¤ cd åˆ°å‰ç«¯ç›®å½•
    defaults:
      run:
        working-directory: frontend/skillspace

    # æ­¥éª¤åˆ—è¡¨ï¼šæŒ‰é¡ºåºæ‰§è¡Œçš„ä»»åŠ¡æ­¥éª¤
    steps:
      # æ­¥éª¤1ï¼šæ£€å‡ºä»£ç 
      # ä½¿ç”¨ GitHub å®˜æ–¹æä¾›çš„ checkout action
      # ä½œç”¨ï¼šå°†ä»£ç ä»“åº“å…‹éš†åˆ°è¿è¡Œå™¨ä¸­
      - name: ðŸ“¥ æ£€å‡ºä»£ç 
        uses: actions/checkout@v4

      # æ­¥éª¤2ï¼šè®¾ç½® Node.js çŽ¯å¢ƒ
      # ä½¿ç”¨ GitHub å®˜æ–¹çš„ setup-node action
      # ä½œç”¨ï¼šå®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ Node.js å’Œ npm
      - name: ðŸŸ¢ è®¾ç½® Node.js ${{ env.NODE_VERSION }}
        uses: actions/setup-node@v4
        with:
          # ä»Žå…¨å±€çŽ¯å¢ƒå˜é‡è¯»å– Node.js ç‰ˆæœ¬
          node-version: ${{ env.NODE_VERSION }}
          
          # å¯ç”¨ npm ç¼“å­˜ï¼šåŠ é€ŸåŽç»­æž„å»º
          # GitHub Actions ä¼šè‡ªåŠ¨ç¼“å­˜ node_modules
          cache: 'npm'
          
          # æŒ‡å®š package-lock.json è·¯å¾„ç”¨äºŽç¼“å­˜é”®è®¡ç®—
          # å½“ package-lock.json æ”¹å˜æ—¶ï¼Œç¼“å­˜ä¼šè‡ªåŠ¨å¤±æ•ˆ
          cache-dependency-path: frontend/skillspace/package-lock.json
      
      # æ­¥éª¤3ï¼šå®‰è£…å‰ç«¯ä¾èµ–
      # ä½¿ç”¨ npm ci è€Œä¸æ˜¯ npm install çš„åŽŸå› ï¼š
      # - npm ci ä¼šåˆ é™¤çŽ°æœ‰çš„ node_modules å¹¶è¿›è¡Œå…¨æ–°å®‰è£…
      # - é€Ÿåº¦æ›´å¿«ï¼Œé€‚åˆ CI çŽ¯å¢ƒ
      # - ç¡®ä¿å®‰è£…çš„ä¾èµ–ä¸Ž package-lock.json å®Œå…¨ä¸€è‡´
      - name: ðŸ“¦ å®‰è£…å‰ç«¯ä¾èµ–
        run: |
          echo "å¼€å§‹å®‰è£…Vueã€Element Plusç­‰å‰ç«¯ä¾èµ–..."
          # --prefer-offline: ä¼˜å…ˆä½¿ç”¨ç¼“å­˜ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚
          # --no-audit: è·³è¿‡å®‰å…¨å®¡è®¡ï¼ŒåŠ å¿«å®‰è£…é€Ÿåº¦
          npm ci --prefer-offline --no-audit
          echo "âœ… å‰ç«¯ä¾èµ–å®‰è£…å®Œæˆ"
      
      # æ­¥éª¤4ï¼šæž„å»ºå‰ç«¯ç”Ÿäº§ç‰ˆæœ¬
      # æ‰§è¡Œ Vite æž„å»ºå‘½ä»¤ï¼Œç”Ÿæˆä¼˜åŒ–åŽçš„é™æ€æ–‡ä»¶
      - name: ðŸ—ï¸ æž„å»ºå‰ç«¯ç”Ÿäº§ç‰ˆæœ¬
        run: |
          echo "å¼€å§‹æž„å»ºViteç”Ÿäº§ç‰ˆæœ¬..."
          # npm run build ä¼šæ‰§è¡Œ package.json ä¸­å®šä¹‰çš„ build è„šæœ¬
          # Vite ä¼šå°†ä»£ç æ‰“åŒ…ã€åŽ‹ç¼©ã€ä¼˜åŒ–å¹¶è¾“å‡ºåˆ° dist/ ç›®å½•
          npm run build
          echo "âœ… å‰ç«¯æž„å»ºå®Œæˆï¼Œè¾“å‡ºç›®å½•: dist/"
      
      # æ­¥éª¤5ï¼šä¸Šä¼ å‰ç«¯æž„å»ºäº§ç‰©
      # å°†æž„å»ºå¥½çš„é™æ€æ–‡ä»¶ä¸Šä¼ ä¸º artifact
      # ä½œç”¨ï¼šä¾›åŽç»­çš„éƒ¨ç½²æ­¥éª¤æˆ–å…¶ä»–ä½œä¸šä½¿ç”¨
      - name: ðŸ“¤ ä¸Šä¼ å‰ç«¯æž„å»ºäº§ç‰©
        uses: actions/upload-artifact@v4
        with:
          # artifact åç§°ï¼šå¯ä»¥åœ¨å…¶ä»–ä½œä¸šä¸­é€šè¿‡æ­¤åç§°ä¸‹è½½
          name: frontend-dist
          
          # è¦ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„ï¼šVite æž„å»ºè¾“å‡ºç›®å½•
          path: ${{ env.FRONTEND_BUILD_DIR }}
          
          # artifact ä¿ç•™å¤©æ•°ï¼š7å¤©åŽè‡ªåŠ¨åˆ é™¤
          retention-days: 7
          
          # å¦‚æžœæ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶åˆ™æŠ¥é”™
          if-no-files-found: error

  # ========================================
  # ä½œä¸š2ï¼šåŽç«¯æµ‹è¯•å’Œæ£€æŸ¥ï¼ˆä½¿ç”¨ç‹¬ç«‹æµ‹è¯•é…ç½®ï¼‰
  # ç›®çš„ï¼šè¿è¡Œ Django å•å…ƒæµ‹è¯•ï¼ŒéªŒè¯åŽç«¯ä»£ç è´¨é‡
  # æ•°æ®åº“ï¼šSQLite å†…å­˜æ•°æ®åº“ï¼ˆå¿«é€Ÿã€æ— éœ€é…ç½®ï¼‰
  # ========================================
  backend-test:
    # ä½œä¸šæ˜¾ç¤ºåç§°
    name: åŽç«¯æµ‹è¯•ä¸Žæ£€æŸ¥ (Django + settings.py)
    
    # è¿è¡ŒçŽ¯å¢ƒï¼šUbuntu æœ€æ–°ç‰ˆ
    runs-on: ubuntu-latest
    
    # é»˜è®¤å·¥ä½œç›®å½•ï¼šåŽç«¯é¡¹ç›®æ ¹ç›®å½•
    defaults:
      run:
        working-directory: backend
    
    # ---------------------------------------------------
    # æœåŠ¡å®¹å™¨é…ç½®
    # GitHub Actions ä¼šåœ¨ä½œä¸šè¿è¡Œå‰è‡ªåŠ¨å¯åŠ¨è¿™äº› Docker å®¹å™¨
    # è¿™äº›æœåŠ¡å¯ä»¥åœ¨æ­¥éª¤ä¸­é€šè¿‡ localhost è®¿é—®
    # ---------------------------------------------------
    services:
      # Redis æœåŠ¡å®¹å™¨ï¼ˆå¯é€‰ï¼‰
      # ç”¨é€”ï¼šæµ‹è¯• Celery å¼‚æ­¥ä»»åŠ¡åŠŸèƒ½
      # æ³¨æ„ï¼šsettings.py é»˜è®¤ä½¿ç”¨å†…å­˜æ¨¡å¼ï¼Œä¸ä¾èµ–çœŸå®ž Redis
      redis:
        # ä½¿ç”¨å®˜æ–¹ Redis 7 Alpine é•œåƒï¼ˆä½“ç§¯å°ï¼Œå¯åŠ¨å¿«ï¼‰
        image: redis:7-alpine
        
        # ç«¯å£æ˜ å°„ï¼šå°†å®¹å™¨çš„ 6379 ç«¯å£æ˜ å°„åˆ°è¿è¡Œå™¨çš„ 6379 ç«¯å£
        ports:
          - 6379:6379
        
        # å¥åº·æ£€æŸ¥é…ç½®ï¼šç¡®ä¿ Redis å®Œå…¨å¯åŠ¨åŽæ‰æ‰§è¡ŒåŽç»­æ­¥éª¤
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5

    # æ­¥éª¤åˆ—è¡¨
    steps:
      # æ­¥éª¤1ï¼šæ£€å‡ºä»£ç 
      - name: ðŸ“¥ æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
      
      # æ­¥éª¤2ï¼šè®¾ç½® Python çŽ¯å¢ƒ
      # ä½¿ç”¨ GitHub å®˜æ–¹çš„ setup-python action
      - name: ðŸ è®¾ç½® Python ${{ env.PYTHON_VERSION }}
        uses: actions/setup-python@v5
        with:
          # Python ç‰ˆæœ¬ï¼šä»Žå…¨å±€çŽ¯å¢ƒå˜é‡è¯»å–
          python-version: ${{ env.PYTHON_VERSION }}
          
          # å¯ç”¨ pip ç¼“å­˜ï¼šåŠ é€Ÿä¾èµ–å®‰è£…
          # GitHub Actions ä¼šè‡ªåŠ¨ç¼“å­˜ pip ä¸‹è½½çš„åŒ…
          cache: 'pip'
          
          # ç¼“å­˜é”®ä¾èµ–æ–‡ä»¶ï¼šå½“ requirements.txt æ”¹å˜æ—¶ç¼“å­˜å¤±æ•ˆ
          cache-dependency-path: backend/requirements.txt
      
      # æ­¥éª¤3ï¼šå®‰è£…åŽç«¯ä¾èµ–
      # åŒ…æ‹¬ Djangoã€PyTorchï¼ˆCPUç‰ˆæœ¬ï¼‰ç­‰æ‰€æœ‰é¡¹ç›®ä¾èµ–
      - name: ðŸ“¦ å®‰è£…åŽç«¯ä¾èµ–
        run: |
          # å‡çº§ pip åˆ°æœ€æ–°ç‰ˆæœ¬
          python -m pip install --upgrade pip
          
          # åˆ†ç¦» PyTorch å®‰è£…ï¼ˆä½¿ç”¨ CPU ç‰ˆæœ¬åŠ é€Ÿ CIï¼‰
          # åŽŸå› ï¼šGPU ç‰ˆæœ¬çš„ PyTorch ä½“ç§¯å¤§ï¼ˆ>2GBï¼‰ï¼Œä¸‹è½½æ…¢
          # è§£å†³æ–¹æ¡ˆï¼šä»Ž requirements.txt ä¸­è¿‡æ»¤æŽ‰ torch ç›¸å…³åŒ…
          grep -v "torch" requirements.txt > requirements.ci.txt
          
          # å®‰è£… CPU ç‰ˆæœ¬çš„ PyTorch
          # --index-url: æŒ‡å®š PyTorch å®˜æ–¹çš„ CPU ç‰ˆæœ¬ä¸‹è½½æº
          pip install torch==2.4.1 torchvision==0.19.1 torchaudio==2.4.1 --index-url https://download.pytorch.org/whl/cpu
          
          # å®‰è£…é¡¹ç›®å…¶ä»–ä¾èµ–ï¼ˆDjangoã€DRF ç­‰ï¼‰
          pip install -r requirements.ci.txt
          
          echo "âœ… åŽç«¯ä¾èµ–å®‰è£…å®Œæˆ"
      
      # ---------------------------------------------------
      # æ­¥éª¤4ï¼šé…ç½®æµ‹è¯•çŽ¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰
      # settings.py å·²ç»æä¾›äº†æ‰€æœ‰å¿…è¦çš„é»˜è®¤é…ç½®
      # è¿™é‡Œåˆ›å»º .env æ–‡ä»¶ä»…ç”¨äºŽè¦†ç›–é»˜è®¤å€¼ï¼ˆå¦‚æžœéœ€è¦ï¼‰
      # ---------------------------------------------------
      - name: âš™ï¸ é…ç½®æµ‹è¯•çŽ¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰
        run: |
          # settings.py å·²æä¾›æ‰€æœ‰å¿…è¦çš„é»˜è®¤é…ç½®
          # è¿™é‡Œä»…åœ¨éœ€è¦è¦†ç›–é»˜è®¤å€¼æ—¶åˆ›å»º .env æ–‡ä»¶
          cat > .env << EOF
          # å¯é€‰ï¼šä½¿ç”¨çœŸå®ž Redisï¼ˆå¦‚æžœéœ€è¦æµ‹è¯• Celery å¼‚æ­¥ä»»åŠ¡ï¼‰
          # settings.py é»˜è®¤ä½¿ç”¨å†…å­˜æ¨¡å¼ memory://ï¼Œæ— éœ€çœŸå®ž Redis
          CELERY_BROKER_URL=redis://localhost:6379/0
          CELERY_RESULT_BACKEND=redis://localhost:6379/0
          EOF
          
          echo "âœ… çŽ¯å¢ƒå˜é‡å·²é…ç½®ï¼ˆsettings.py æä¾›é»˜è®¤å€¼ï¼‰"

      # æ­¥éª¤5ï¼šDjango ç³»ç»Ÿæ£€æŸ¥
      # ä½œç”¨ï¼šæ£€æŸ¥ Django é…ç½®æ˜¯å¦æ­£ç¡®ï¼Œæ˜¯å¦æœ‰é”™è¯¯æˆ–è­¦å‘Š
      # --settings: æŒ‡å®šä½¿ç”¨æµ‹è¯•é…ç½®æ–‡ä»¶ settings.py
      - name: ðŸ” Djangoç³»ç»Ÿæ£€æŸ¥
        run: python manage.py check --settings=SkillSpace.settings

      # æ­¥éª¤6ï¼šæ‰§è¡Œæ•°æ®åº“è¿ç§»
      # ä½œç”¨ï¼šå°† Django æ¨¡åž‹åŒæ­¥åˆ°æ•°æ®åº“ï¼ˆåˆ›å»ºè¡¨ç»“æž„ï¼‰
      # settings.py ä½¿ç”¨ SQLite å†…å­˜æ•°æ®åº“ (:memory:)
      # ä¼˜åŠ¿ï¼šæ— éœ€é…ç½®ï¼Œé€Ÿåº¦å¿«ï¼Œæµ‹è¯•åŽè‡ªåŠ¨é”€æ¯
      - name: ðŸ—„ï¸ æ‰§è¡Œæ•°æ®åº“è¿ç§»
        run: |
          echo "å¼€å§‹æ•°æ®åº“è¿ç§»ï¼ˆSQLite å†…å­˜æ•°æ®åº“ï¼‰..."
          # --verbosity=2: æ˜¾ç¤ºè¯¦ç»†çš„è¿ç§»ä¿¡æ¯
          python manage.py migrate --settings=SkillSpace.settings --verbosity=2
          echo "âœ… æ•°æ®åº“è¿ç§»å®Œæˆ"

      # æ­¥éª¤7ï¼šè¿è¡ŒåŽç«¯å•å…ƒæµ‹è¯•
      # ä½œç”¨ï¼šæ‰§è¡Œæ‰€æœ‰ Django æµ‹è¯•ç”¨ä¾‹ï¼ŒéªŒè¯ä»£ç åŠŸèƒ½
      # settings.py ä¼˜åŒ–é…ç½®ï¼š
      # - ä½¿ç”¨ MD5 å¯†ç å“ˆå¸Œï¼ˆæ¯” PBKDF2 å¿«10å€ï¼‰
      # - Celery åŒæ­¥æ‰§è¡Œä»»åŠ¡ï¼ˆCELERY_TASK_ALWAYS_EAGER=Trueï¼‰
      # - å†…å­˜é‚®ä»¶åŽç«¯ï¼ˆä¸å‘é€çœŸå®žé‚®ä»¶ï¼‰
      - name: ðŸ§ª è¿è¡ŒåŽç«¯å•å…ƒæµ‹è¯•
        run: |
          echo "å¼€å§‹è¿è¡Œ Django å•å…ƒæµ‹è¯•ï¼ˆä½¿ç”¨ settings.pyï¼‰..."
          # --verbosity=2: æ˜¾ç¤ºè¯¦ç»†çš„æµ‹è¯•ä¿¡æ¯
          # Django ä¼šè‡ªåŠ¨åˆ›å»ºæµ‹è¯•æ•°æ®åº“ï¼ˆSQLite :memory:ï¼‰
          python manage.py test --settings=SkillSpace.settings --verbosity=2
          echo "âœ… æµ‹è¯•å®Œæˆ"

  # ========================================
  # ä½œä¸š3ï¼šä»£ç è´¨é‡æ£€æŸ¥ï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰
  # ç›®çš„ï¼šé›†æˆä»£ç é£Žæ ¼æ£€æŸ¥å·¥å…·ï¼ˆå ä½ç¬¦ï¼‰
  # å¯é›†æˆå·¥å…·ï¼šFlake8ï¼ˆPythonï¼‰ã€Blackï¼ˆPythonæ ¼å¼åŒ–ï¼‰ã€ESLintï¼ˆJavaScriptï¼‰
  # ========================================
  code-quality:
    # ä½œä¸šæ˜¾ç¤ºåç§°
    name: ä»£ç è´¨é‡æ£€æŸ¥
    
    # è¿è¡ŒçŽ¯å¢ƒ
    runs-on: ubuntu-latest
    
    # æ­¥éª¤åˆ—è¡¨
    steps:
      # æ£€å‡ºä»£ç 
      - uses: actions/checkout@v4
      
      # å ä½æ­¥éª¤ï¼šå¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å®žé™…çš„ä»£ç è´¨é‡æ£€æŸ¥
      # ä¾‹å¦‚ï¼šflake8 æ£€æŸ¥ Python ä»£ç é£Žæ ¼
      #      black æ£€æŸ¥ Python ä»£ç æ ¼å¼
      #      eslint æ£€æŸ¥ JavaScript ä»£ç 
      - name: ðŸ” è¿è¡Œæ£€æŸ¥ (å ä½)
        run: echo "æ­¤å¤„é›†æˆ Flake8 / Black / ESLint"

  # ========================================
  # ä½œä¸š4ï¼šæž„å»ºæˆåŠŸé€šçŸ¥
  # ç›®çš„ï¼šæ‰€æœ‰ä½œä¸šæˆåŠŸåŽå‘é€é€šçŸ¥
  # ä¾èµ–ï¼šç­‰å¾…å‰é¢3ä¸ªä½œä¸šå…¨éƒ¨å®Œæˆ
  # ========================================
  build-success:
    # ä½œä¸šæ˜¾ç¤ºåç§°
    name: âœ… æž„å»ºæˆåŠŸ
    
    # è¿è¡ŒçŽ¯å¢ƒ
    runs-on: ubuntu-latest
    
    # needs: å®šä¹‰ä¾èµ–å…³ç³»
    # åªæœ‰å½“ frontend-test-buildã€backend-testã€code-quality 
    # è¿™3ä¸ªä½œä¸šéƒ½æˆåŠŸå®ŒæˆåŽï¼Œæ‰ä¼šæ‰§è¡Œæ­¤ä½œä¸š
    needs: [frontend-test-build, backend-test, code-quality]
    
    # æ­¥éª¤åˆ—è¡¨
    steps:
      # é€šçŸ¥æ­¥éª¤ï¼šå¯ä»¥æ‰©å±•ä¸ºå‘é€é‚®ä»¶ã€Slackæ¶ˆæ¯ç­‰
      - name: ðŸŽ‰ é€šçŸ¥
        run: echo "CI Pipeline å…¨éƒ¨é€šè¿‡ï¼Œå‡†å¤‡å°±ç»ªï¼"

# ========================================
# CD æŒç»­éƒ¨ç½²æž¶æž„å»ºè®® (ä¿ç•™ä¾›å‚è€ƒ)
# ä»¥ä¸‹ä¸ºæ³¨é‡Šå†…å®¹ï¼Œå®žé™…ä½¿ç”¨æ—¶éœ€è¦å–æ¶ˆæ³¨é‡Šå¹¶é…ç½®
# ========================================
# 
#  deploy-production:
#    if: github.ref == 'refs/heads/main'
#    needs: build-success
#    ... (æ­¤å¤„ä¿ç•™ä½ åŽŸæ–‡ä»¶ä¸­çš„ CD é…ç½®æ³¨é‡Šï¼Œä¸åšæ”¹åŠ¨) ...
