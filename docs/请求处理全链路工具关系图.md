# SkillSpace è¯·æ±‚å¤„ç†å…¨é“¾è·¯å·¥å…·å…³ç³»å›¾

## ğŸ“Œ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£ä»**ç”¨æˆ·è¯·æ±‚çš„è§’åº¦**å‡ºå‘ï¼Œè¯¦ç»†å±•ç¤ºè¯·æ±‚ä»å‘èµ·åˆ°å“åº”çš„å®Œæ•´é“¾è·¯ï¼ŒåŒ…æ‹¬ï¼š
- ç»è¿‡çš„æ‰€æœ‰ä¸­é—´ä»¶ã€æ¡†æ¶ç»„ä»¶
- æ¯ä¸ªå·¥å…·/ç»„ä»¶çš„å¤„ç†é€»è¾‘
- æ•°æ®æµè½¬è¿‡ç¨‹
- æœ€ç»ˆå¦‚ä½•è¿”å›ç»™ç”¨æˆ·

æ¶µç›–**4ç§å…¸å‹è¯·æ±‚åœºæ™¯**ï¼š
1. âœ… **REST APIè¯·æ±‚**ï¼ˆç”¨æˆ·ç®¡ç†ã€ç®€å†ç®¡ç†ç­‰ï¼‰
2. âœ… **AIå¯¹è¯è¯·æ±‚ - SSEæµå¼æ¨¡å¼**
3. âœ… **AIå¯¹è¯è¯·æ±‚ - WebSocketå¼‚æ­¥æ¨¡å¼**
4. âœ… **Celeryå¼‚æ­¥ä»»åŠ¡è¯·æ±‚**

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          å‰ç«¯å±‚ (Vue3)                               â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Axios/Fetch â”‚  â”‚  EventSource â”‚  â”‚  WebSocket   â”‚             â”‚
â”‚  â”‚  (REST API)  â”‚  â”‚  (SSEæµå¼)    â”‚  â”‚  (å®æ—¶åŒå‘)   â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ HTTP             â”‚ HTTP SSE         â”‚ WS Protocol
          â†“                  â†“                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”‚        Django ASGI (Daphne)         â”‚                    â”‚
â”‚         â”‚                  â”‚                  â”‚                    â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                            â†“                                        â”‚
â”‚                    [ä¸­é—´ä»¶å¤„ç†é“¾]                                    â”‚
â”‚                            â†“                                        â”‚
â”‚                     [è·¯ç”±åˆ†å‘å™¨]                                     â”‚
â”‚                            â†“                                        â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚              â”‚                           â”‚                         â”‚
â”‚       [REST Framework]          [WebSocket Consumer]               â”‚
â”‚              â”‚                           â”‚                         â”‚
â”‚       [æƒé™æ§åˆ¶å±‚]                  [Channel Layer]                  â”‚
â”‚              â”‚                           â”‚                         â”‚
â”‚       [ä¸šåŠ¡é€»è¾‘å±‚]                  [Celery Worker]                  â”‚
â”‚              â”‚                           â”‚                         â”‚
â”‚       [ORMæ•°æ®å±‚]                   [AIæ¨¡å‹æ¨ç†]                     â”‚
â”‚              â”‚                           â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                           â”‚
               â†“                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              â”‚        æ•°æ®å­˜å‚¨å±‚          â”‚                         â”‚
â”‚              â”‚                           â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  MySQL/SQLite  â”‚  â”‚  Redis   â”‚  â”‚RabbitMQ â”‚  â”‚  GPUæ˜¾å­˜   â”‚    â”‚
â”‚  â”‚  (ä¸šåŠ¡æ•°æ®)     â”‚  â”‚ (ç¼“å­˜)    â”‚  â”‚(ä»»åŠ¡é˜Ÿåˆ—)â”‚  â”‚ (AIæ¨¡å‹)   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” åœºæ™¯ä¸€ï¼šREST API è¯·æ±‚å®Œæ•´é“¾è·¯

### ç¤ºä¾‹ï¼šåˆ›å»ºç”¨æˆ·è¯·æ±‚

```
POST /api/auth/users/
{
  "email": "test@example.com",
  "username": "test",
  "password": "123456"
}
```

### å®Œæ•´å¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬1æ­¥ï¼šå‰ç«¯å‘èµ·è¯·æ±‚                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Axios.post('/api/auth/users/', data)
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬2æ­¥ï¼šNginx åå‘ä»£ç†ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰                                     â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: Nginx                                                          â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. æ¥æ”¶HTTPè¯·æ±‚                                                     â”‚
â”‚    2. SSLç»ˆæ­¢ï¼ˆHTTPS â†’ HTTPï¼‰                                         â”‚
â”‚    3. è´Ÿè½½å‡è¡¡ï¼ˆå¤šå°DjangoæœåŠ¡å™¨ï¼‰                                      â”‚
â”‚    4. æ·»åŠ ä»£ç†å¤´ï¼ˆX-Forwarded-For, X-Real-IPï¼‰                         â”‚
â”‚    5. è½¬å‘åˆ°Django                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ proxy_pass http://127.0.0.1:8000
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬3æ­¥ï¼šDjango ASGI åº”ç”¨å…¥å£                                           â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: Daphne (ASGIæœåŠ¡å™¨)                                            â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. æ¥æ”¶HTTPè¯·æ±‚                                                     â”‚
â”‚    2. åˆ›å»º HttpRequest å¯¹è±¡                                           â”‚
â”‚    3. è¿›å…¥ä¸­é—´ä»¶å¤„ç†é“¾                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬4æ­¥ï¼šä¸­é—´ä»¶å¤„ç†é“¾ï¼ˆæŒ‰é¡ºåºæ‰§è¡Œï¼‰                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä¸­é—´ä»¶ 1: CorsMiddleware                                    â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
    â”‚ å·¥å…·: django-cors-headers                                   â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ æ£€æŸ¥è¯·æ±‚æ¥æº (Origin)                                     â”‚
    â”‚   â€¢ éªŒè¯æ˜¯å¦åœ¨ CORS_ALLOWED_ORIGINS ç™½åå•ä¸­                 â”‚
    â”‚   â€¢ æ·»åŠ  CORS å“åº”å¤´:                                        â”‚
    â”‚     - Access-Control-Allow-Origin                          â”‚
    â”‚     - Access-Control-Allow-Credentials                     â”‚
    â”‚   â€¢ å¤„ç†é¢„æ£€è¯·æ±‚ (OPTIONS)                                   â”‚
    â”‚                                                              â”‚
    â”‚ âœ… é€šè¿‡ â†’ ç»§ç»­ä¸‹ä¸€ä¸ªä¸­é—´ä»¶                                    â”‚
    â”‚ âŒ æ‹’ç» â†’ è¿”å› 403 Forbidden                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä¸­é—´ä»¶ 2: SecurityMiddleware                                â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
    â”‚ å·¥å…·: Djangoå†…ç½®                                             â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ è®¾ç½®å®‰å…¨å“åº”å¤´:                                           â”‚
    â”‚     - X-Content-Type-Options: nosniff                      â”‚
    â”‚     - X-Frame-Options: DENY                                â”‚
    â”‚   â€¢ å¼ºåˆ¶HTTPSé‡å®šå‘ï¼ˆå¦‚é…ç½®ï¼‰                                 â”‚
    â”‚   â€¢ SSLé‡å®šå‘                                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä¸­é—´ä»¶ 3: SessionMiddleware                                 â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ å·¥å…·: Djangoå†…ç½®                                             â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ ä» Cookie ä¸­è¯»å– sessionid                               â”‚
    â”‚   â€¢ ä» Redis/æ•°æ®åº“ åŠ è½½ä¼šè¯æ•°æ®                             â”‚
    â”‚   â€¢ å°†ä¼šè¯æ•°æ®é™„åŠ åˆ° request.session                         â”‚
    â”‚   â€¢ é…ç½®:                                                     â”‚
    â”‚     - SESSION_COOKIE_AGE: 86400 (24å°æ—¶)                   â”‚
    â”‚     - SESSION_COOKIE_HTTPONLY: True                        â”‚
    â”‚     - SESSION_SAVE_EVERY_REQUEST: True                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä¸­é—´ä»¶ 4: CommonMiddleware                                  â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ å·¥å…·: Djangoå†…ç½®                                             â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ URLè§„èŒƒåŒ–ï¼ˆæ·»åŠ å°¾éƒ¨æ–œæ ï¼‰                                 â”‚
    â”‚   â€¢ è®¾ç½® Content-Length å¤´                                  â”‚
    â”‚   â€¢ ETagsç”Ÿæˆï¼ˆç¼“å­˜æ§åˆ¶ï¼‰                                     â”‚
    â”‚   â€¢ ç¦ç”¨æµè§ˆå™¨ç¼“å­˜ï¼ˆå¦‚é…ç½®ï¼‰                                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä¸­é—´ä»¶ 5: CsrfViewMiddleware                                â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ å·¥å…·: Djangoå†…ç½®                                             â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ éªŒè¯ CSRF Tokenï¼ˆPOST/PUT/DELETEè¯·æ±‚ï¼‰                   â”‚
    â”‚   â€¢ æ£€æŸ¥ä»¥ä¸‹ä½ç½®:                                             â”‚
    â”‚     1. X-CSRFToken è¯·æ±‚å¤´                                    â”‚
    â”‚     2. csrfmiddlewaretoken POSTå‚æ•°                         â”‚
    â”‚   â€¢ éªŒè¯ Referer å¤´                                          â”‚
    â”‚   â€¢ æ£€æŸ¥æ¥æºæ˜¯å¦åœ¨ CSRF_TRUSTED_ORIGINS ä¸­                   â”‚
    â”‚   â€¢ è®¾ç½®å“åº”Cookie: csrftoken                               â”‚
    â”‚                                                              â”‚
    â”‚ âœ… éªŒè¯é€šè¿‡ â†’ ç»§ç»­                                            â”‚
    â”‚ âŒ éªŒè¯å¤±è´¥ â†’ è¿”å› 403 CSRFéªŒè¯å¤±è´¥                           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä¸­é—´ä»¶ 6: AuthenticationMiddleware                          â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ å·¥å…·: Djangoå†…ç½®                                             â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ ä» Session ä¸­è·å–ç”¨æˆ·ID                                   â”‚
    â”‚   â€¢ ä»æ•°æ®åº“åŠ è½½ç”¨æˆ·å¯¹è±¡                                       â”‚
    â”‚   â€¢ å°†ç”¨æˆ·é™„åŠ åˆ° request.user                                â”‚
    â”‚   â€¢ å¦‚æœæœªç™»å½•ï¼Œrequest.user = AnonymousUser                â”‚
    â”‚                                                              â”‚
    â”‚ æ•°æ®åº“æŸ¥è¯¢:                                                   â”‚
    â”‚   SELECT * FROM auth_system_user WHERE id = {session_user_id}â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä¸­é—´ä»¶ 7: MessageMiddleware                                 â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ å·¥å…·: Djangoå†…ç½®                                             â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ å¤„ç†Flashæ¶ˆæ¯ï¼ˆä¸€æ¬¡æ€§æç¤ºä¿¡æ¯ï¼‰                           â”‚
    â”‚   â€¢ ä» Session ä¸­è¯»å–æ¶ˆæ¯                                     â”‚
    â”‚   â€¢ é™„åŠ åˆ° request._messages                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä¸­é—´ä»¶ 8: OperationLogMiddleware (è‡ªå®šä¹‰)                   â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ å·¥å…·: è‡ªå®šä¹‰ä¸­é—´ä»¶ (auth_system.middleware)                  â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´                                          â”‚
    â”‚   â€¢ æå–è¯·æ±‚ä¿¡æ¯:                                             â”‚
    â”‚     - ç”¨æˆ·: request.user.username                           â”‚
    â”‚     - IP: X-Forwarded-For æˆ– REMOTE_ADDR                   â”‚
    â”‚     - æ–¹æ³•: POST/PUT/DELETE                                 â”‚
    â”‚     - è·¯å¾„: /api/auth/users/                                â”‚
    â”‚     - å‚æ•°: {"email": "test@example.com", ...}              â”‚
    â”‚   â€¢ æš‚å­˜ä¿¡æ¯ï¼Œç­‰å¾…å“åº”æ—¶è®°å½•                                   â”‚
    â”‚                                                              â”‚
    â”‚ æ³¨æ„: åªè®°å½• POST/PUT/DELETE/PATCH è¯·æ±‚                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬5æ­¥ï¼šURLè·¯ç”±åŒ¹é…                                                    â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: Django URL Dispatcher                                         â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. è§£æè¯·æ±‚è·¯å¾„: /api/auth/users/                                  â”‚
â”‚    2. åŒ¹é… urls.py ä¸­çš„è·¯ç”±è§„åˆ™:                                       â”‚
â”‚       path("api/auth/", include("auth_system.urls"))                â”‚
â”‚    3. è¿›å…¥ auth_system.urls ç»§ç»­åŒ¹é…:                                â”‚
â”‚       path("users/", UserViewSet.as_view({...}))                    â”‚
â”‚    4. æ‰¾åˆ°ç›®æ ‡è§†å›¾: UserViewSet                                        â”‚
â”‚    5. æå–URLå‚æ•°ï¼ˆå¦‚æœ‰ï¼‰                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬6æ­¥ï¼šDRF (Django REST Framework) å¤„ç†                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ DRFå±‚ 1: è¯·æ±‚è§£æ                                            â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
    â”‚ å·¥å…·: DRF Request Parser                                    â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ åŒ…è£… HttpRequest ä¸º DRF Request å¯¹è±¡                     â”‚
    â”‚   â€¢ è§£æè¯·æ±‚ä½“ï¼ˆJSON/FormDataï¼‰                              â”‚
    â”‚   â€¢ è§£æ Content-Type                                       â”‚
    â”‚   â€¢ æå–æŸ¥è¯¢å‚æ•°: request.query_params                       â”‚
    â”‚   â€¢ æå–è¯·æ±‚æ•°æ®: request.data                               â”‚
    â”‚                                                              â”‚
    â”‚ ç»“æœ:                                                         â”‚
    â”‚   request.data = {                                          â”‚
    â”‚     "email": "test@example.com",                           â”‚
    â”‚     "username": "test",                                     â”‚
    â”‚     "password": "123456"                                    â”‚
    â”‚   }                                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ DRFå±‚ 2: è®¤è¯éªŒè¯                                            â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
    â”‚ å·¥å…·: DRF Authentication Classes                            â”‚
    â”‚ é…ç½®: SessionAuthentication, BasicAuthentication            â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ æ‰§è¡Œè®¤è¯ç±»:                                               â”‚
    â”‚     1. SessionAuthentication (å·²åœ¨ä¸­é—´ä»¶å¤„ç†)                â”‚
    â”‚     2. BasicAuthentication (æ£€æŸ¥ Authorization å¤´)          â”‚
    â”‚   â€¢ è®¾ç½® request.user å’Œ request.auth                       â”‚
    â”‚                                                              â”‚
    â”‚ âœ… è®¤è¯æˆåŠŸ â†’ request.user = Userå¯¹è±¡                         â”‚
    â”‚ âŒ è®¤è¯å¤±è´¥ â†’ request.user = AnonymousUser                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ DRFå±‚ 3: æƒé™æ§åˆ¶                                            â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
    â”‚ å·¥å…·: DRF Permission Classes                                â”‚
    â”‚ é…ç½®: AllowAny (é»˜è®¤), IsAuthenticated (è§†å›¾çº§)              â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ æ£€æŸ¥è§†å›¾çº§æƒé™è£…é¥°å™¨                                       â”‚
    â”‚   â€¢ æ‰§è¡Œè‡ªå®šä¹‰æƒé™ç±»:                                          â”‚
    â”‚     - permission_required('system:user:add')               â”‚
    â”‚   â€¢ éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰è¯¥æƒé™:                                    â”‚
    â”‚     1. æ£€æŸ¥ is_superuser (è¶…çº§ç®¡ç†å‘˜é€šè¿‡)                     â”‚
    â”‚     2. æŸ¥è¯¢ç”¨æˆ·è§’è‰²å…³è”çš„èœå•æƒé™                              â”‚
    â”‚                                                              â”‚
    â”‚ æ•°æ®åº“æŸ¥è¯¢:                                                   â”‚
    â”‚   SELECT m.perms                                            â”‚
    â”‚   FROM auth_system_menu m                                   â”‚
    â”‚   JOIN sys_role_menu rm ON m.id = rm.menu_id               â”‚
    â”‚   JOIN auth_system_user_roles ur ON rm.role_id = ur.role_idâ”‚
    â”‚   WHERE ur.user_id = {user_id}                              â”‚
    â”‚                                                              â”‚
    â”‚ âœ… æœ‰æƒé™ â†’ ç»§ç»­å¤„ç†                                          â”‚
    â”‚ âŒ æ— æƒé™ â†’ è¿”å› 403 æƒé™ä¸è¶³                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ DRFå±‚ 4: é™æµæ§åˆ¶                                            â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
    â”‚ å·¥å…·: DRF Throttle Classes                                  â”‚
    â”‚ é…ç½®: AnonRateThrottle, UserRateThrottle (å¦‚é…ç½®)           â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ æ£€æŸ¥è¯·æ±‚é¢‘ç‡é™åˆ¶                                          â”‚
    â”‚   â€¢ ä» Redis/ç¼“å­˜ ä¸­è¯»å–è¯·æ±‚è®¡æ•°                             â”‚
    â”‚   â€¢ æ›´æ–°è¯·æ±‚è®¡æ•°                                              â”‚
    â”‚                                                              â”‚
    â”‚ RedisæŸ¥è¯¢:                                                   â”‚
    â”‚   INCR throttle_anon_{ip}                                   â”‚
    â”‚   EXPIRE throttle_anon_{ip} 60                              â”‚
    â”‚                                                              â”‚
    â”‚ âœ… æœªè¶…é™ â†’ ç»§ç»­å¤„ç†                                          â”‚
    â”‚ âŒ è¶…é™ â†’ è¿”å› 429 è¯·æ±‚è¿‡å¤š                                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ DRFå±‚ 5: åºåˆ—åŒ–å™¨éªŒè¯                                         â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
    â”‚ å·¥å…·: DRF Serializer                                         â”‚
    â”‚ ç±»: UserSerializer                                           â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ åˆå§‹åŒ–åºåˆ—åŒ–å™¨: UserSerializer(data=request.data)         â”‚
    â”‚   â€¢ æ‰§è¡Œå­—æ®µéªŒè¯:                                             â”‚
    â”‚     - email: EmailField(required=True, unique=True)        â”‚
    â”‚     - username: CharField(max_length=150)                  â”‚
    â”‚     - password: CharField(min_length=6, write_only=True)   â”‚
    â”‚   â€¢ æ‰§è¡Œè‡ªå®šä¹‰éªŒè¯æ–¹æ³•:                                        â”‚
    â”‚     - validate_email(): æ£€æŸ¥é‚®ç®±æ ¼å¼ã€æ˜¯å¦å·²å­˜åœ¨              â”‚
    â”‚     - validate_password(): æ£€æŸ¥å¯†ç å¼ºåº¦                      â”‚
    â”‚   â€¢ æ‰§è¡Œè·¨å­—æ®µéªŒè¯: validate()                                â”‚
    â”‚                                                              â”‚
    â”‚ æ•°æ®åº“æŸ¥è¯¢:                                                   â”‚
    â”‚   SELECT COUNT(*) FROM auth_system_user                     â”‚
    â”‚   WHERE email = 'test@example.com'                         â”‚
    â”‚                                                              â”‚
    â”‚ âœ… éªŒè¯é€šè¿‡ â†’ serializer.is_valid() = True                   â”‚
    â”‚ âŒ éªŒè¯å¤±è´¥ â†’ è¿”å› 400 + é”™è¯¯è¯¦æƒ…                             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬7æ­¥ï¼šè§†å›¾ä¸šåŠ¡é€»è¾‘å¤„ç†                                               â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: UserViewSet (DRF ViewSet)                                     â”‚
â”‚  æ–¹æ³•: create()                                                       â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. è·å–éªŒè¯åçš„æ•°æ®: serializer.validated_data                     â”‚
â”‚    2. æ‰§è¡Œä¸šåŠ¡é€»è¾‘:                                                    â”‚
â”‚       - å¯†ç åŠ å¯†: make_password(password)                             â”‚
â”‚       - åˆ›å»ºç”¨æˆ·å¯¹è±¡                                                   â”‚
â”‚       - åˆ†é…é»˜è®¤è§’è‰²ï¼ˆå¦‚é…ç½®ï¼‰                                          â”‚
â”‚    3. ä¿å­˜åˆ°æ•°æ®åº“: serializer.save()                                 â”‚
â”‚    4. è¿”å›åˆ›å»ºç»“æœ                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬8æ­¥ï¼šORM æ•°æ®æŒä¹…åŒ–                                                 â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: Django ORM                                                     â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. æ„å»ºSQLè¯­å¥ï¼ˆå‚æ•°åŒ–æŸ¥è¯¢ï¼Œé˜²SQLæ³¨å…¥ï¼‰                             â”‚
â”‚    2. æ‰§è¡Œæ•°æ®åº“å†™å…¥                                                   â”‚
â”‚    3. è·å–æ–°è®°å½•ID                                                     â”‚
â”‚    4. è§¦å‘ post_save ä¿¡å·ï¼ˆå¦‚æœ‰ï¼‰                                      â”‚
â”‚                                                                       â”‚
â”‚  æ•°æ®åº“æ“ä½œ:                                                           â”‚
â”‚    BEGIN;                                                             â”‚
â”‚    INSERT INTO auth_system_user (email, username, password, ...)     â”‚
â”‚    VALUES ('test@example.com', 'test', 'pbkdf2$...', ...);           â”‚
â”‚    COMMIT;                                                            â”‚
â”‚                                                                       â”‚
â”‚  ç»“æœ: Userå¯¹è±¡ (id=123)                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬9æ­¥ï¼šå“åº”åºåˆ—åŒ–                                                     â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: DRF Serializer                                                 â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. å°†Userå¯¹è±¡åºåˆ—åŒ–ä¸ºJSON                                           â”‚
â”‚    2. è¿‡æ»¤æ•æ„Ÿå­—æ®µï¼ˆpasswordï¼‰                                          â”‚
â”‚    3. æ ¼å¼åŒ–æ—¶é—´å­—æ®µ                                                   â”‚
â”‚    4. æ·»åŠ å…³è”å­—æ®µï¼ˆroles, permissionsï¼‰                               â”‚
â”‚                                                                       â”‚
â”‚  è¾“å‡º:                                                                 â”‚
â”‚    {                                                                  â”‚
â”‚      "id": 123,                                                       â”‚
â”‚      "email": "test@example.com",                                    â”‚
â”‚      "username": "test",                                              â”‚
â”‚      "roles": [],                                                     â”‚
â”‚      "created_at": "2025-12-16T10:30:00Z"                            â”‚
â”‚    }                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬10æ­¥ï¼šDRF å“åº”åŒ…è£…                                                  â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: DRF Response Renderer                                         â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. åŒ…è£…ä¸ºæ ‡å‡†å“åº”æ ¼å¼                                               â”‚
â”‚    2. è®¾ç½®HTTPçŠ¶æ€ç : 201 Created                                     â”‚
â”‚    3. æ·»åŠ å“åº”å¤´:                                                      â”‚
â”‚       - Content-Type: application/json                               â”‚
â”‚       - Location: /api/auth/users/123/                               â”‚
â”‚    4. æ¸²æŸ“ä¸ºJSONå­—ç¬¦ä¸²                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬11æ­¥ï¼šä¸­é—´ä»¶å“åº”åå¤„ç†ï¼ˆé€†åºæ‰§è¡Œï¼‰                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ OperationLogMiddleware (å“åº”é˜¶æ®µ)                           â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ è®¡ç®—è¯·æ±‚è€—æ—¶: end_time - start_time                      â”‚
    â”‚   â€¢ æå–å“åº”çŠ¶æ€ç : 201                                       â”‚
    â”‚   â€¢ æå–å“åº”æ•°æ®ï¼ˆå‰500å­—ç¬¦ï¼‰                                 â”‚
    â”‚   â€¢ æ¨æ–­æ“ä½œæ¨¡å—å’Œç±»å‹:                                       â”‚
    â”‚     - module: "ç”¨æˆ·ç®¡ç†"                                     â”‚
    â”‚     - action: "æ–°å¢"                                         â”‚
    â”‚   â€¢ åˆ›å»ºæ“ä½œæ—¥å¿—è®°å½•:                                         â”‚
    â”‚                                                              â”‚
    â”‚ æ•°æ®åº“å†™å…¥:                                                   â”‚
    â”‚   INSERT INTO auth_system_operationlog (                    â”‚
    â”‚     user_id, username, module, action,                      â”‚
    â”‚     method, url, ip_address, request_params,                â”‚
    â”‚     response_data, status, duration, created_at             â”‚
    â”‚   ) VALUES (                                                 â”‚
    â”‚     1, 'admin', 'ç”¨æˆ·ç®¡ç†', 'æ–°å¢',                          â”‚
    â”‚     'POST', '/api/auth/users/', '192.168.1.100',            â”‚
    â”‚     '{"email":"test@example.com",...}',                     â”‚
    â”‚     '{"id":123,...}', '0', 156, NOW()                       â”‚
    â”‚   );                                                         â”‚
    â”‚                                                              â”‚
    â”‚ æ—¥å¿—è¾“å‡º:                                                     â”‚
    â”‚   [æ“ä½œæ—¥å¿—] admin | POST /api/auth/users/ |                â”‚
    â”‚   æ¨¡å—: ç”¨æˆ·ç®¡ç† | æ“ä½œ: æ–°å¢ | ç»“æœ: æˆåŠŸ | è€—æ—¶: 156ms      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ SessionMiddleware (å“åº”é˜¶æ®µ)                                â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ ä¿å­˜ Session æ•°æ®åˆ° Redis/æ•°æ®åº“                         â”‚
    â”‚   â€¢ æ›´æ–° Session è¿‡æœŸæ—¶é—´                                    â”‚
    â”‚   â€¢ è®¾ç½®å“åº” Cookie:                                         â”‚
    â”‚     Set-Cookie: sessionid=abc123; HttpOnly; SameSite=Lax   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CorsMiddleware (å“åº”é˜¶æ®µ)                                   â”‚
    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
    â”‚ å¤„ç†:                                                        â”‚
    â”‚   â€¢ æ·»åŠ  CORS å“åº”å¤´:                                        â”‚
    â”‚     Access-Control-Allow-Origin: http://localhost:5173     â”‚
    â”‚     Access-Control-Allow-Credentials: true                 â”‚
    â”‚     Access-Control-Expose-Headers: Content-Type, ...       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬12æ­¥ï¼šè¿”å›å“åº”                                                      â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: Daphne / Nginx                                                â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. æ„å»ºHTTPå“åº”æŠ¥æ–‡                                                â”‚
â”‚    2. å‘é€ç»™å®¢æˆ·ç«¯                                                     â”‚
â”‚                                                                       â”‚
â”‚  HTTPå“åº”:                                                            â”‚
â”‚    HTTP/1.1 201 Created                                              â”‚
â”‚    Content-Type: application/json                                    â”‚
â”‚    Access-Control-Allow-Origin: http://localhost:5173               â”‚
â”‚    Set-Cookie: sessionid=abc123; HttpOnly                           â”‚
â”‚                                                                       â”‚
â”‚    {                                                                  â”‚
â”‚      "id": 123,                                                       â”‚
â”‚      "email": "test@example.com",                                    â”‚
â”‚      "username": "test",                                              â”‚
â”‚      "created_at": "2025-12-16T10:30:00Z"                            â”‚
â”‚    }                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬13æ­¥ï¼šå‰ç«¯æ¥æ”¶å¤„ç†                                                  â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: Axios / Vue3                                                   â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    axios.post('/api/auth/users/', data)                             â”‚
â”‚      .then(response => {                                             â”‚
â”‚        // response.status = 201                                      â”‚
â”‚        // response.data = {id: 123, ...}                             â”‚
â”‚        ElMessage.success('ç”¨æˆ·åˆ›å»ºæˆåŠŸ')                              â”‚
â”‚        router.push('/users')                                         â”‚
â”‚      })                                                               â”‚
â”‚      .catch(error => {                                               â”‚
â”‚        // å¤„ç†é”™è¯¯                                                     â”‚
â”‚      })                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” åœºæ™¯äºŒï¼šAIå¯¹è¯è¯·æ±‚ - SSEæµå¼æ¨¡å¼

### ç¤ºä¾‹ï¼šå‘AIæé—®

```
POST /api/ai/qwen/
{
  "prompt": "ä»‹ç»ä¸€ä¸‹Pythonè¯­è¨€",
  "session_id": "session-123",
  "stream": true
}
```

### å®Œæ•´å¤„ç†æµç¨‹ï¼ˆé‡ç‚¹å…³æ³¨ä¸åœºæ™¯ä¸€çš„å·®å¼‚ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç½®å¤„ç†ï¼šä¸åœºæ™¯ä¸€ç›¸åŒ                                                 â”‚
â”‚ ï¼ˆç»è¿‡æ‰€æœ‰ä¸­é—´ä»¶ â†’ è·¯ç”±åŒ¹é… â†’ DRFå¤„ç†ï¼‰                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…³é”®æ­¥éª¤1ï¼šè°ƒç”¨æœ¬åœ°AIæ¨¡å‹                                             â”‚
â”‚                                                                       â”‚
â”‚  æ–‡ä»¶: model_loader.py                                                â”‚
â”‚  å‡½æ•°: stream_generate_answer()                                      â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. åŠ è½½æ¨¡å‹ï¼ˆå•ä¾‹æ¨¡å¼ï¼Œå·²é¢„åŠ è½½ï¼‰                                   â”‚
â”‚       â€¢ æ¨¡å‹: Qwen2.5-7B-Instruct (4-bité‡åŒ–)                        â”‚
â”‚       â€¢ æ˜¾å­˜: ~4GB                                                    â”‚
â”‚       â€¢ è®¾å¤‡: CUDA:0 (GPUæ¨ç†)                                        â”‚
â”‚                                                                       â”‚
â”‚    2. æ„å»ºå¯¹è¯ä¸Šä¸‹æ–‡                                                   â”‚
â”‚       messages = [                                                    â”‚
â”‚         {"role": "system", "content": SYSTEM_PROMPT},                â”‚
â”‚         {"role": "user", "content": "ä»‹ç»ä¸€ä¸‹Pythonè¯­è¨€"}             â”‚
â”‚       ]                                                               â”‚
â”‚                                                                       â”‚
â”‚    3. åº”ç”¨å¯¹è¯æ¨¡æ¿                                                     â”‚
â”‚       text = tokenizer.apply_chat_template(messages)                 â”‚
â”‚       # ç»“æœ: "<|im_start|>system\nä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹...<|im_end|>..."   â”‚
â”‚                                                                       â”‚
â”‚    4. Tokenizeè¾“å…¥                                                    â”‚
â”‚       inputs = tokenizer([text], return_tensors="pt").to("cuda")    â”‚
â”‚       # ç»“æœ: {"input_ids": tensor([[101, 234, ...]]), ...}          â”‚
â”‚                                                                       â”‚
â”‚    5. åˆ›å»ºæµå¼è¾“å‡ºå™¨                                                   â”‚
â”‚       streamer = TextIteratorStreamer(                               â”‚
â”‚         tokenizer,                                                    â”‚
â”‚         skip_prompt=True,                                            â”‚
â”‚         skip_special_tokens=True                                     â”‚
â”‚       )                                                               â”‚
â”‚                                                                       â”‚
â”‚    6. å¯åŠ¨æ¨ç†çº¿ç¨‹                                                     â”‚
â”‚       thread = Thread(target=model.generate, kwargs={                â”‚
â”‚         "inputs": inputs,                                             â”‚
â”‚         "streamer": streamer,                                        â”‚
â”‚         "max_new_tokens": 2048,                                      â”‚
â”‚         "temperature": 0.7,                                          â”‚
â”‚         "top_p": 0.8,                                                â”‚
â”‚         "use_cache": True  # âœ… KVç¼“å­˜åŠ é€Ÿ                            â”‚
â”‚       })                                                              â”‚
â”‚       thread.start()                                                 â”‚
â”‚                                                                       â”‚
â”‚    7. é€tokenç”Ÿæˆï¼ˆç”Ÿæˆå™¨æ¨¡å¼ï¼‰                                        â”‚
â”‚       for new_text in streamer:                                      â”‚
â”‚         # è§£æXMLæ ‡è®° <thinking>...</thinking>                       â”‚
â”‚         # è§£æXMLæ ‡è®° <answer>...</answer>                           â”‚
â”‚         yield {"token": token, "type": "answer"}                    â”‚
â”‚                                                                       â”‚
â”‚ GPUæ“ä½œ:                                                              â”‚
â”‚   â€¢ æ³¨æ„åŠ›è®¡ç®— (Flash Attention 2)                                    â”‚
â”‚   â€¢ çŸ©é˜µä¹˜æ³• (GEMM, TF32åŠ é€Ÿ)                                         â”‚
â”‚   â€¢ Softmaxå½’ä¸€åŒ–                                                     â”‚
â”‚   â€¢ Tokené‡‡æ · (Top-P + Top-K)                                        â”‚
â”‚                                                                       â”‚
â”‚ æ€§èƒ½æ•°æ®:                                                             â”‚
â”‚   â€¢ é¦–tokenå»¶è¿Ÿ: ~300-500ms                                           â”‚
â”‚   â€¢ æ¨ç†é€Ÿåº¦: ~40 tokens/s (RTX 3080)                                â”‚
â”‚   â€¢ æ˜¾å­˜å ç”¨: 4.2GB                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…³é”®æ­¥éª¤2ï¼šSSEæµå¼å“åº”                                                â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: Django StreamingHttpResponse                                  â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    def event_stream():                                               â”‚
â”‚      full_answer = ""                                                â”‚
â”‚      for chunk in generator:  # ä»AIæ¨¡å‹è·å–token                    â”‚
â”‚        token = chunk["token"]                                        â”‚
â”‚        chunk_type = chunk["type"]  # thinking æˆ– answer             â”‚
â”‚                                                                       â”‚
â”‚        # ç´¯ç§¯ç­”æ¡ˆ                                                      â”‚
â”‚        if chunk_type == "answer":                                    â”‚
â”‚          full_answer += token                                        â”‚
â”‚                                                                       â”‚
â”‚        # SSEæ ¼å¼æ¨é€                                                  â”‚
â”‚        yield f"data: {json.dumps({                                   â”‚
â”‚          'code': 200,                                                â”‚
â”‚          'token': token,  # å•ä¸ªtoken: "Python"                     â”‚
â”‚          'type': chunk_type                                          â”‚
â”‚        })}\n\n"                                                      â”‚
â”‚                                                                       â”‚
â”‚        # ç»“æŸä¿¡å·                                                      â”‚
â”‚        if chunk_type == "finish":                                    â”‚
â”‚          break                                                        â”‚
â”‚                                                                       â”‚
â”‚      # ä¿å­˜å®Œæ•´å¯¹è¯åˆ°æ•°æ®åº“                                            â”‚
â”‚      ChatRecord.objects.create(                                      â”‚
â”‚        session_id="session-123",                                     â”‚
â”‚        role="assistant",                                             â”‚
â”‚        content=full_answer                                           â”‚
â”‚      )                                                                â”‚
â”‚                                                                       â”‚
â”‚    # è¿”å›SSEå“åº”                                                      â”‚
â”‚    response = StreamingHttpResponse(                                 â”‚
â”‚      event_stream(),                                                 â”‚
â”‚      content_type="text/event-stream"                               â”‚
â”‚    )                                                                  â”‚
â”‚    response["Cache-Control"] = "no-cache"                           â”‚
â”‚    response["X-Accel-Buffering"] = "no"  # ç¦ç”¨Nginxç¼“å†²            â”‚
â”‚    return response                                                   â”‚
â”‚                                                                       â”‚
â”‚ æ•°æ®æµ:                                                               â”‚
â”‚   AIæ¨¡å‹ â†’ ç”Ÿæˆå™¨ â†’ event_stream() â†’ HTTPå“åº”æµ â†’ å‰ç«¯              â”‚
â”‚                                                                       â”‚
â”‚ HTTPå“åº”ç¤ºä¾‹:                                                         â”‚
â”‚   HTTP/1.1 200 OK                                                    â”‚
â”‚   Content-Type: text/event-stream                                   â”‚
â”‚   Cache-Control: no-cache                                           â”‚
â”‚                                                                       â”‚
â”‚   data: {"code":200,"token":"Python","type":"answer"}               â”‚
â”‚                                                                       â”‚
â”‚   data: {"code":200,"token":"æ˜¯","type":"answer"}                   â”‚
â”‚                                                                       â”‚
â”‚   data: {"code":200,"token":"ä¸€é—¨","type":"answer"}                 â”‚
â”‚                                                                       â”‚
â”‚   data: {"code":200,"token":"","type":"finish"}                     â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…³é”®æ­¥éª¤3ï¼šå‰ç«¯EventSourceæ¥æ”¶                                        â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: EventSource API (æµè§ˆå™¨åŸç”Ÿ)                                   â”‚
â”‚  ä»£ç :                                                                 â”‚
â”‚    const eventSource = new EventSource('/api/ai/qwen/', {            â”‚
â”‚      method: 'POST',                                                 â”‚
â”‚      body: JSON.stringify(data)                                      â”‚
â”‚    })                                                                 â”‚
â”‚                                                                       â”‚
â”‚    let aiResponse = ''                                               â”‚
â”‚                                                                       â”‚
â”‚    eventSource.onmessage = (event) => {                              â”‚
â”‚      const data = JSON.parse(event.data)                            â”‚
â”‚                                                                       â”‚
â”‚      if (data.type === 'answer') {                                   â”‚
â”‚        // é€å­—æ˜¾ç¤º                                                     â”‚
â”‚        aiResponse += data.token                                      â”‚
â”‚        this.displayText = aiResponse  // Vueå“åº”å¼æ›´æ–°               â”‚
â”‚      }                                                                â”‚
â”‚                                                                       â”‚
â”‚      if (data.type === 'finish') {                                   â”‚
â”‚        eventSource.close()  // å…³é—­è¿æ¥                              â”‚
â”‚      }                                                                â”‚
â”‚    }                                                                  â”‚
â”‚                                                                       â”‚
â”‚ ç”¨æˆ·ä½“éªŒ:                                                             â”‚
â”‚   â€¢ æ‰“å­—æœºæ•ˆæœï¼ˆé€å­—æ˜¾ç¤ºï¼‰                                             â”‚
â”‚   â€¢ å®æ—¶åé¦ˆï¼ˆæ— éœ€ç­‰å¾…å®Œæ•´å“åº”ï¼‰                                        â”‚
â”‚   â€¢ é¦–å­—å»¶è¿Ÿ: <500ms                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” åœºæ™¯ä¸‰ï¼šAIå¯¹è¯è¯·æ±‚ - WebSocketå¼‚æ­¥æ¨¡å¼

### ç¤ºä¾‹ï¼šå¼‚æ­¥AIå¯¹è¯

```
POST /api/ai/qwen-async/
{
  "prompt": "ä»‹ç»ä¸€ä¸‹Pythonè¯­è¨€",
  "session_id": "session-456"
}
```

### å®Œæ•´å¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬1æ­¥ï¼šæäº¤å¼‚æ­¥ä»»åŠ¡                                                   â”‚
â”‚                                                                       â”‚
â”‚  è§†å›¾: QwenChatAsyncAPI                                               â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. ç”Ÿæˆå”¯ä¸€ task_id = str(uuid.uuid4())                           â”‚
â”‚       â†’ "abc-123-def-456"                                            â”‚
â”‚                                                                       â”‚
â”‚    2. æ„å»º WebSocket URL                                             â”‚
â”‚       â†’ ws://localhost:8000/ws/ai/abc-123-def-456/                  â”‚
â”‚                                                                       â”‚
â”‚    3. æäº¤ Celery å¼‚æ­¥ä»»åŠ¡                                            â”‚
â”‚       task = qwen_chat_task_streaming.delay(                        â”‚
â”‚         task_id="abc-123-def-456",                                   â”‚
â”‚         prompt="ä»‹ç»ä¸€ä¸‹Pythonè¯­è¨€",                                  â”‚
â”‚         history=[...]                                                â”‚
â”‚       )                                                               â”‚
â”‚                                                                       â”‚
â”‚    4. ä¿å­˜ä»»åŠ¡è®°å½•åˆ°æ•°æ®åº“                                             â”‚
â”‚       AITask.objects.create(                                         â”‚
â”‚         task_id="abc-123-def-456",                                   â”‚
â”‚         celery_task_id=task.id,                                      â”‚
â”‚         user=request.user,                                           â”‚
â”‚         prompt="ä»‹ç»ä¸€ä¸‹Pythonè¯­è¨€",                                  â”‚
â”‚         status='pending',                                            â”‚
â”‚         ws_url=ws_url                                                â”‚
â”‚       )                                                               â”‚
â”‚                                                                       â”‚
â”‚    5. ç«‹å³è¿”å›å“åº”ï¼ˆä¸ç­‰å¾…AIæ¨ç†ï¼‰                                     â”‚
â”‚       return Response({                                              â”‚
â”‚         "code": 200,                                                 â”‚
â”‚         "data": {                                                     â”‚
â”‚           "task_id": "abc-123-def-456",                              â”‚
â”‚           "celery_task_id": task.id,                                 â”‚
â”‚           "ws_url": ws_url                                           â”‚
â”‚         }                                                             â”‚
â”‚       })                                                              â”‚
â”‚                                                                       â”‚
â”‚ æ—¶é—´: ~50msï¼ˆä»…æäº¤ä»»åŠ¡ï¼Œä¸æ‰§è¡ŒAIæ¨ç†ï¼‰                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚                                           â”‚
                         â†“                                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬2æ­¥ï¼šå‰ç«¯å»ºç«‹WebSocketè¿æ¥          â”‚  â”‚ ç¬¬3æ­¥ï¼šCelery Workerå¤„ç†ä»»åŠ¡          â”‚
â”‚                                       â”‚  â”‚                                       â”‚
â”‚  å‰ç«¯ä»£ç :                             â”‚  â”‚  ç»„ä»¶: RabbitMQ + Celery Worker      â”‚
â”‚    const ws = new WebSocket(         â”‚  â”‚  æµç¨‹:                                 â”‚
â”‚      ws://localhost:8000/ws/ai/      â”‚  â”‚                                       â”‚
â”‚      abc-123-def-456/                â”‚  â”‚  1. RabbitMQæ¥æ”¶ä»»åŠ¡                  â”‚
â”‚    )                                  â”‚  â”‚     â€¢ ä»»åŠ¡ID: task.id                 â”‚
â”‚                                       â”‚  â”‚     â€¢ é˜Ÿåˆ—: celery (é»˜è®¤)              â”‚
â”‚  å·¥å…·: WebSocket API                  â”‚  â”‚     â€¢ ä¼˜å…ˆçº§: Normal                  â”‚
â”‚                                       â”‚  â”‚                                       â”‚
â”‚  Djangoå¤„ç†:                          â”‚  â”‚  2. Workerä»é˜Ÿåˆ—æ‹‰å–ä»»åŠ¡              â”‚
â”‚    â€¢ è·¯ç”±åŒ¹é…:                         â”‚  â”‚     celery -A SkillSpace worker     â”‚
â”‚      ws/ai/<task_id>/                â”‚  â”‚                                       â”‚
â”‚    â€¢ è§¦å‘Consumer:                    â”‚  â”‚  3. æ‰§è¡Œä»»åŠ¡å‡½æ•°                      â”‚
â”‚      AIChatConsumer.connect()        â”‚  â”‚     qwen_chat_task_streaming()       â”‚
â”‚                                       â”‚  â”‚                                       â”‚
â”‚  Consumerå¤„ç†:                        â”‚  â”‚  4. è°ƒç”¨AIæ¨¡å‹ç”Ÿæˆ                    â”‚
â”‚    async def connect(self):           â”‚  â”‚     generator = stream_generate_     â”‚
â”‚      # æå–task_id                    â”‚  â”‚       answer(prompt, history)        â”‚
â”‚      self.task_id = "abc-123-..."    â”‚  â”‚                                       â”‚
â”‚                                       â”‚  â”‚  5. é€tokenæ¨é€åˆ°Redis Channel        â”‚
â”‚      # åŠ å…¥Channel Group              â”‚  â”‚     for chunk in generator:          â”‚
â”‚      await self.channel_layer.        â”‚  â”‚       channel_layer.group_send(      â”‚
â”‚        group_add(                     â”‚  â”‚         "ai_abc-123-...",            â”‚
â”‚          "ai_abc-123-...",           â”‚  â”‚         {                             â”‚
â”‚          self.channel_name            â”‚  â”‚           "type": "ai_message",      â”‚
â”‚        )                              â”‚  â”‚           "token": chunk["token"],   â”‚
â”‚                                       â”‚  â”‚           "chunk_type": "answer"     â”‚
â”‚      # æ¥å—è¿æ¥                        â”‚  â”‚         }                             â”‚
â”‚      await self.accept()              â”‚  â”‚       )                               â”‚
â”‚                                       â”‚  â”‚                                       â”‚
â”‚  å»ºç«‹è¿æ¥: ~20ms                       â”‚  â”‚  GPUæ¨ç†: ~5-10ç§’                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                                          â”‚
                         â”‚                                          â†“
                         â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚                  â”‚ ç¬¬4æ­¥ï¼šRedis Channel Layeræ¶ˆæ¯åˆ†å‘   â”‚
                         â”‚                  â”‚                                       â”‚
                         â”‚                  â”‚  å·¥å…·: channels_redis                 â”‚
                         â”‚                  â”‚  å­˜å‚¨: Redis DB1                      â”‚
                         â”‚                  â”‚                                       â”‚
                         â”‚                  â”‚  å¤„ç†:                                 â”‚
                         â”‚                  â”‚    â€¢ æ¥æ”¶Workeræ¨é€çš„æ¶ˆæ¯              â”‚
                         â”‚                  â”‚    â€¢ æ‰¾åˆ°è®¢é˜…çš„Consumer                â”‚
                         â”‚                  â”‚      (é€šè¿‡ channel_name)              â”‚
                         â”‚                  â”‚    â€¢ è½¬å‘æ¶ˆæ¯åˆ°Consumer                â”‚
                         â”‚                  â”‚                                       â”‚
                         â”‚                  â”‚  Redisæ“ä½œ:                            â”‚
                         â”‚                  â”‚    PUBLISH ai_abc-123-...             â”‚
                         â”‚                  â”‚      '{"type":"ai_message",...}'      â”‚
                         â”‚                  â”‚                                       â”‚
                         â”‚                  â”‚  å»¶è¿Ÿ: <10ms                           â”‚
                         â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                                          â”‚
                         â”‚                                          â†“
                         â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚                  â”‚ ç¬¬5æ­¥ï¼šConsumerè½¬å‘æ¶ˆæ¯               â”‚
                         â”‚                  â”‚                                       â”‚
                         â”‚                  â”‚  Consumerä»£ç :                        â”‚
                         â”‚                  â”‚    async def ai_message(self, event): â”‚
                         â”‚                  â”‚      # æ¥æ”¶æ¥è‡ªChannel Layerçš„æ¶ˆæ¯    â”‚
                         â”‚                  â”‚      await self.send(                 â”‚
                         â”‚                  â”‚        text_data=json.dumps({         â”‚
                         â”‚                  â”‚          "code": 200,                 â”‚
                         â”‚                  â”‚          "token": event["token"],     â”‚
                         â”‚                  â”‚          "type": event["chunk_type"]  â”‚
                         â”‚                  â”‚        })                              â”‚
                         â”‚                  â”‚      )                                 â”‚
                         â”‚                  â”‚                                       â”‚
                         â”‚                  â”‚  å»¶è¿Ÿ: <5ms                            â”‚
                         â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                                          â”‚
                         â”‚                                          â†“
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬6æ­¥ï¼šå‰ç«¯æ¥æ”¶WebSocketæ¶ˆæ¯                                          â”‚
â”‚                                                                       â”‚
â”‚  å‰ç«¯ä»£ç :                                                             â”‚
â”‚    ws.onmessage = (event) => {                                       â”‚
â”‚      const data = JSON.parse(event.data)                            â”‚
â”‚      console.log(data)  // {code:200, token:"Python", type:"answer"}â”‚
â”‚                                                                       â”‚
â”‚      if (data.type === 'answer') {                                   â”‚
â”‚        this.aiResponse += data.token                                 â”‚
â”‚      }                                                                â”‚
â”‚                                                                       â”‚
â”‚      if (data.type === 'finish') {                                   â”‚
â”‚        ws.close()                                                    â”‚
â”‚      }                                                                â”‚
â”‚    }                                                                  â”‚
â”‚                                                                       â”‚
â”‚  ä¼˜åŠ¿:                                                                 â”‚
â”‚    â€¢ åŒå‘é€šä¿¡ï¼ˆæ”¯æŒå¿ƒè·³ã€ç”¨æˆ·æ‰“æ–­ï¼‰                                     â”‚
â”‚    â€¢ ä½å»¶è¿Ÿï¼ˆ<100msç«¯åˆ°ç«¯ï¼‰                                            â”‚
â”‚    â€¢ è§£è€¦æ¶æ„ï¼ˆDjangoä¸è¢«é˜»å¡ï¼‰                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®Œæ•´æ•°æ®æµå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    POST     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   delay()   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   æ‹‰å–    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ Django  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ RabbitMQ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ Celery â”‚
â”‚         â”‚  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ (REST)  â”‚             â”‚  (é˜Ÿåˆ—)   â”‚          â”‚ Worker â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   task_id   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
     â”‚         ws_url                                                       â”‚
     â”‚                                                                      â”‚
     â”‚ WebSocket                                                            â”‚ AIæ¨ç†
     â”‚ è¿æ¥                                                                  â”‚
     â†“                                                                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   group_send â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯    â”‚  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ WS      â”‚  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  Redis   â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Celery â”‚
â”‚ (WS)   â”‚   æ¨é€      â”‚Consumer â”‚   è½¬å‘      â”‚ Channel  â”‚    æ¨é€      â”‚ Worker â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  å®æ—¶æ˜¾ç¤º                è®¢é˜…Group              æ¶ˆæ¯åˆ†å‘                 é€tokenç”Ÿæˆ
```

---

## ğŸ” åœºæ™¯å››ï¼šCeleryå¼‚æ­¥ä»»åŠ¡è¯·æ±‚

### ç¤ºä¾‹ï¼šç”Ÿæˆç®€å†æŠ¥å‘Š

```
POST /api/tasks/submit/
{
  "task_type": "generate_resume_pdf",
  "resume_id": 123
}
```

### å®Œæ•´å¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬1æ­¥ï¼šæäº¤å¼‚æ­¥ä»»åŠ¡                                                   â”‚
â”‚                                                                       â”‚
â”‚  è§†å›¾: TaskSubmitView                                                 â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. éªŒè¯å‚æ•°                                                         â”‚
â”‚    2. æäº¤Celeryä»»åŠ¡                                                  â”‚
â”‚       from tasks_hub.tasks import generate_resume_pdf_task           â”‚
â”‚       task = generate_resume_pdf_task.delay(resume_id=123)          â”‚
â”‚                                                                       â”‚
â”‚    3. ä¿å­˜ä»»åŠ¡è®°å½•                                                     â”‚
â”‚       TaskRecord.objects.create(                                     â”‚
â”‚         celery_task_id=task.id,                                      â”‚
â”‚         task_type='generate_resume_pdf',                            â”‚
â”‚         status='PENDING'                                             â”‚
â”‚       )                                                               â”‚
â”‚                                                                       â”‚
â”‚    4. è¿”å›ä»»åŠ¡ID                                                       â”‚
â”‚       return Response({"task_id": task.id})                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬2æ­¥ï¼šRabbitMQæ¥æ”¶ä»»åŠ¡                                               â”‚
â”‚                                                                       â”‚
â”‚  å·¥å…·: RabbitMQ                                                       â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    â€¢ ä»»åŠ¡è¿›å…¥é˜Ÿåˆ—: celery                                              â”‚
â”‚    â€¢ æŒä¹…åŒ–å­˜å‚¨ï¼ˆé˜²æ­¢ä¸¢å¤±ï¼‰                                             â”‚
â”‚    â€¢ ç­‰å¾…Workeræ‹‰å–                                                    â”‚
â”‚                                                                       â”‚
â”‚  AMQPæ“ä½œ:                                                            â”‚
â”‚    PUBLISH exchange=celery                                           â”‚
â”‚      routing_key=celery                                              â”‚
â”‚      body={                                                           â”‚
â”‚        "task": "tasks_hub.tasks.generate_resume_pdf_task",          â”‚
â”‚        "args": [],                                                    â”‚
â”‚        "kwargs": {"resume_id": 123}                                  â”‚
â”‚      }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬3æ­¥ï¼šCelery Workerå¤„ç†                                              â”‚
â”‚                                                                       â”‚
â”‚  è¿›ç¨‹: celery -A SkillSpace worker                                    â”‚
â”‚  å¤„ç†:                                                                 â”‚
â”‚    1. ä»RabbitMQæ‹‰å–ä»»åŠ¡                                              â”‚
â”‚    2. æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸º STARTED                                           â”‚
â”‚       self.update_state(state='STARTED')                             â”‚
â”‚                                                                       â”‚
â”‚    3. æ‰§è¡Œä»»åŠ¡é€»è¾‘:                                                    â”‚
â”‚       def generate_resume_pdf_task(self, resume_id):                â”‚
â”‚         # ä»æ•°æ®åº“åŠ è½½ç®€å†                                             â”‚
â”‚         resume = Resume.objects.get(id=resume_id)                   â”‚
â”‚                                                                       â”‚
â”‚         # æ›´æ–°è¿›åº¦                                                     â”‚
â”‚         self.update_state(                                           â”‚
â”‚           state='PROGRESS',                                          â”‚
â”‚           meta={'current': 1, 'total': 3}                            â”‚
â”‚         )                                                             â”‚
â”‚                                                                       â”‚
â”‚         # ç”ŸæˆPDF                                                     â”‚
â”‚         pdf_path = generate_pdf(resume)                              â”‚
â”‚                                                                       â”‚
â”‚         # æ›´æ–°è¿›åº¦                                                     â”‚
â”‚         self.update_state(                                           â”‚
â”‚           state='PROGRESS',                                          â”‚
â”‚           meta={'current': 2, 'total': 3}                            â”‚
â”‚         )                                                             â”‚
â”‚                                                                       â”‚
â”‚         # ä¸Šä¼ åˆ°OSS                                                   â”‚
â”‚         url = upload_to_oss(pdf_path)                                â”‚
â”‚                                                                       â”‚
â”‚         # è¿”å›ç»“æœ                                                     â”‚
â”‚         return {'url': url, 'status': 'success'}                    â”‚
â”‚                                                                       â”‚
â”‚    4. ä¿å­˜ç»“æœåˆ°Redis                                                 â”‚
â”‚       Redis SET celery-task-result:{task_id} = {result}             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬4æ­¥ï¼šå‰ç«¯è½®è¯¢ä»»åŠ¡çŠ¶æ€                                               â”‚
â”‚                                                                       â”‚
â”‚  å‰ç«¯ä»£ç :                                                             â”‚
â”‚    const pollStatus = setInterval(() => {                            â”‚
â”‚      axios.get(`/api/tasks/status/${task_id}/`)                     â”‚
â”‚        .then(response => {                                           â”‚
â”‚          const status = response.data.state                          â”‚
â”‚          const progress = response.data.meta                         â”‚
â”‚                                                                       â”‚
â”‚          if (status === 'SUCCESS') {                                 â”‚
â”‚            clearInterval(pollStatus)                                 â”‚
â”‚            downloadPDF(response.data.result.url)                     â”‚
â”‚          } else if (status === 'FAILURE') {                          â”‚
â”‚            clearInterval(pollStatus)                                 â”‚
â”‚            showError(response.data.error)                            â”‚
â”‚          } else if (status === 'PROGRESS') {                         â”‚
â”‚            updateProgressBar(progress)                               â”‚
â”‚          }                                                            â”‚
â”‚        })                                                             â”‚
â”‚    }, 1000)  // æ¯ç§’è½®è¯¢ä¸€æ¬¡                                          â”‚
â”‚                                                                       â”‚
â”‚  åç«¯æŸ¥è¯¢:                                                             â”‚
â”‚    def get_task_status(request, task_id):                            â”‚
â”‚      task_result = AsyncResult(task_id)                              â”‚
â”‚      return Response({                                               â”‚
â”‚        "state": task_result.state,  # PENDING/STARTED/SUCCESS/...   â”‚
â”‚        "meta": task_result.info,    # è¿›åº¦ä¿¡æ¯                        â”‚
â”‚        "result": task_result.result  # æœ€ç»ˆç»“æœ                       â”‚
â”‚      })                                                               â”‚
â”‚                                                                       â”‚
â”‚  RedisæŸ¥è¯¢:                                                           â”‚
â”‚    GET celery-task-result:{task_id}                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š å·¥å…·ç»„ä»¶æ±‡æ€»è¡¨

### è¯·æ±‚å…¥å£å±‚

| ç»„ä»¶ | ä½œç”¨ | å…³é”®é…ç½® |
|------|------|---------|
| **Nginx** | åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ã€SSLç»ˆæ­¢ | proxy_pass, upstream |
| **Daphne** | ASGIæœåŠ¡å™¨ï¼Œå¤„ç†HTTPå’ŒWebSocket | daphne -b 0.0.0.0 -p 8000 |

### ä¸­é—´ä»¶å±‚ï¼ˆæŒ‰æ‰§è¡Œé¡ºåºï¼‰

| ä¸­é—´ä»¶ | ä½œç”¨ | å…³é”®å¤„ç† |
|--------|------|---------|
| **CorsMiddleware** | CORSè·¨åŸŸæ§åˆ¶ | éªŒè¯Originã€æ·»åŠ CORSå¤´ |
| **SecurityMiddleware** | å®‰å…¨å“åº”å¤´ | X-Frame-Optionsã€X-Content-Type-Options |
| **SessionMiddleware** | ä¼šè¯ç®¡ç† | ä»Cookieè¯»å–sessionidã€åŠ è½½ä¼šè¯æ•°æ® |
| **CommonMiddleware** | é€šç”¨å¤„ç† | URLè§„èŒƒåŒ–ã€ETagsç”Ÿæˆ |
| **CsrfViewMiddleware** | CSRFé˜²æŠ¤ | éªŒè¯CSRF Tokenã€Refereræ£€æŸ¥ |
| **AuthenticationMiddleware** | ç”¨æˆ·è®¤è¯ | åŠ è½½ç”¨æˆ·å¯¹è±¡åˆ°request.user |
| **MessageMiddleware** | Flashæ¶ˆæ¯ | ä¸€æ¬¡æ€§æç¤ºä¿¡æ¯å¤„ç† |
| **OperationLogMiddleware** | æ“ä½œæ—¥å¿— | è®°å½•APIæ“ä½œã€è®¡ç®—è€—æ—¶ |

### è·¯ç”±ä¸è§†å›¾å±‚

| ç»„ä»¶ | ä½œç”¨ | å…³é”®åŠŸèƒ½ |
|------|------|---------|
| **URL Dispatcher** | è·¯ç”±åŒ¹é… | è§£æURLã€æå–å‚æ•°ã€æ‰¾åˆ°ç›®æ ‡è§†å›¾ |
| **DRF ViewSet** | REST APIè§†å›¾ | CRUDæ“ä½œã€ä¸šåŠ¡é€»è¾‘å¤„ç† |
| **DRF Serializer** | æ•°æ®éªŒè¯ä¸åºåˆ—åŒ– | å­—æ®µéªŒè¯ã€æ ¼å¼è½¬æ¢ã€åµŒå¥—åºåˆ—åŒ– |
| **DRF Permission** | æƒé™æ§åˆ¶ | IsAuthenticatedã€è‡ªå®šä¹‰æƒé™ç±» |
| **DRF Throttle** | é™æµæ§åˆ¶ | AnonRateThrottleã€UserRateThrottle |

### æ•°æ®å±‚

| ç»„ä»¶ | ä½œç”¨ | å…³é”®æ“ä½œ |
|------|------|---------|
| **Django ORM** | å¯¹è±¡å…³ç³»æ˜ å°„ | SQLç”Ÿæˆã€å‚æ•°åŒ–æŸ¥è¯¢ã€äº‹åŠ¡ç®¡ç† |
| **MySQL/SQLite** | å…³ç³»æ•°æ®åº“ | ä¸šåŠ¡æ•°æ®æŒä¹…åŒ– |
| **Redis** | ç¼“å­˜ä¸ä¼šè¯ | Sessionå­˜å‚¨ã€Celeryç»“æœã€Channel Layer |
| **RabbitMQ** | æ¶ˆæ¯é˜Ÿåˆ— | Celeryä»»åŠ¡é˜Ÿåˆ—ã€AMQPåè®® |

### å¼‚æ­¥ä¸å®æ—¶é€šä¿¡å±‚

| ç»„ä»¶ | ä½œç”¨ | å…³é”®åŠŸèƒ½ |
|------|------|---------|
| **Celery** | å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ— | ä»»åŠ¡æäº¤ã€çŠ¶æ€è¿½è¸ªã€é‡è¯•æœºåˆ¶ |
| **Channels** | WebSocketæ”¯æŒ | å®æ—¶åŒå‘é€šä¿¡ |
| **Channel Layer** | æ¶ˆæ¯åˆ†å‘ | è·¨è¿›ç¨‹æ¶ˆæ¯ä¼ é€’ã€Groupå¹¿æ’­ |
| **EventSource** | SSEå®¢æˆ·ç«¯ | å•å‘æµå¼æ•°æ®æ¥æ”¶ |

### AIæ¨ç†å±‚

| ç»„ä»¶ | ä½œç”¨ | å…³é”®ä¼˜åŒ– |
|------|------|---------|
| **Transformers** | AIæ¨¡å‹åº“ | æ¨¡å‹åŠ è½½ã€Tokenization |
| **PyTorch** | æ·±åº¦å­¦ä¹ æ¡†æ¶ | GPUæ¨ç†ã€CUDAåŠ é€Ÿ |
| **BitsAndBytes** | æ¨¡å‹é‡åŒ– | 4-bité‡åŒ–ã€èŠ‚çœæ˜¾å­˜ |
| **Flash Attention** | æ³¨æ„åŠ›ä¼˜åŒ– | åŠ é€Ÿæ¨ç†è®¡ç®— |
| **TextIteratorStreamer** | æµå¼ç”Ÿæˆ | é€tokenè¾“å‡º |

---

## ğŸ¯ æ€§èƒ½æŒ‡æ ‡æ€»ç»“

### å„åœºæ™¯å“åº”æ—¶é—´

| åœºæ™¯ | é¦–å­—èŠ‚å»¶è¿Ÿ | å®Œæ•´å“åº” | ç“¶é¢ˆ |
|------|-----------|---------|------|
| **REST API** | 50-100ms | 100-200ms | æ•°æ®åº“æŸ¥è¯¢ |
| **SSEæµå¼** | 300-500ms | 5-10ç§’ | AIæ¨ç† |
| **WebSocket** | 20-50ms | 5-10ç§’ | AIæ¨ç† |
| **å¼‚æ­¥ä»»åŠ¡** | <50ms | å¼‚æ­¥æ‰§è¡Œ | åå°å¤„ç† |

### å¹¶å‘èƒ½åŠ›

| æ¨¡å¼ | å¹¶å‘è¿æ¥ | é™åˆ¶å› ç´  |
|------|---------|---------|
| **åŒæ­¥REST** | 100-200 | Django Workeræ•°é‡ |
| **SSEæµå¼** | 50-100 | Workeré˜»å¡ |
| **WebSocket** | 1000+ | Channel Layeræ€§èƒ½ |
| **Celery** | æ— é™åˆ¶ | Workeræ•°é‡ |

---

## ğŸš€ ä¼˜åŒ–å»ºè®®

### 1. æ•°æ®åº“ä¼˜åŒ–
- âœ… æ·»åŠ ç´¢å¼•ï¼ˆuser_id, created_at, statusï¼‰
- âœ… ä½¿ç”¨ select_related() å‡å°‘N+1æŸ¥è¯¢
- âœ… æ•°æ®åº“è¿æ¥æ± é…ç½®

### 2. ç¼“å­˜ä¼˜åŒ–
- âœ… Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
- âœ… è§†å›¾çº§ç¼“å­˜ï¼ˆ@cache_pageï¼‰
- âœ… ORMæŸ¥è¯¢ç»“æœç¼“å­˜

### 3. å¼‚æ­¥ä¼˜åŒ–
- âœ… é•¿æ—¶é—´æ“ä½œå…¨éƒ¨æ”¹ä¸ºCelery
- âœ… ä½¿ç”¨WebSocketæ›¿ä»£SSEï¼ˆåŒå‘é€šä¿¡ï¼‰
- âœ… Channel Layerä½¿ç”¨Redisé›†ç¾¤

### 4. AIæ¨ç†ä¼˜åŒ–
- âœ… 4-bité‡åŒ–ï¼ˆæ˜¾å­˜å ç”¨ â†“ 70%ï¼‰
- âœ… Flash Attention 2ï¼ˆæ¨ç†é€Ÿåº¦ â†‘ 25%ï¼‰
- âœ… æ‰¹é‡æ¨ç†ï¼ˆå¤šè¯·æ±‚åˆå¹¶ï¼‰

---

## ğŸ“ æ€»ç»“

æœ¬æ–‡æ¡£è¯¦ç»†å±•ç¤ºäº†SkillSpaceé¡¹ç›®ä»**è¯·æ±‚å‘èµ·åˆ°å“åº”è¿”å›**çš„å®Œæ•´é“¾è·¯ï¼Œæ¶µç›–äº†ï¼š

- âœ… **8ä¸ªä¸­é—´ä»¶**çš„å¤„ç†é€»è¾‘
- âœ… **DRFæ¡†æ¶**çš„5å±‚å¤„ç†
- âœ… **4ç§è¯·æ±‚åœºæ™¯**çš„å®Œæ•´æµç¨‹
- âœ… **20+ä¸ªå·¥å…·ç»„ä»¶**çš„ååŒå·¥ä½œ
- âœ… **æ€§èƒ½æŒ‡æ ‡**ä¸ä¼˜åŒ–å»ºè®®

è¿™ä¸ªæ¶æ„æ”¯æ’‘äº†**ä¼ä¸šçº§çš„åŠŸèƒ½éœ€æ±‚**å’Œ**åƒçº§å¹¶å‘**çš„æ€§èƒ½è¦æ±‚ï¼ğŸš€
